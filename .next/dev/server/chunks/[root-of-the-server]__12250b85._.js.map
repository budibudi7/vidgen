{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/video-gen/app/api/operations/%5B...name%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst externalApiBaseUrl = 'https://generativelanguage.googleapis.com/v1beta';\r\n\r\nexport async function GET(req: NextRequest, props: { params: Promise<{ name: string[] }> }) {\r\n    try {\r\n        const apiKey = process.env.GEMINI_API_KEY || process.env.API_KEY;\r\n        if (!apiKey) {\r\n            return NextResponse.json({ error: 'Server configuration error: API Key missing' }, { status: 500 });\r\n        }\r\n\r\n        const params = await props.params;\r\n        const operationPath = params.name.join('/');\r\n\r\n        // Construct target URL\r\n        const targetUrl = `${externalApiBaseUrl}/${operationPath}?key=${apiKey}`;\r\n\r\n        const response = await fetch(targetUrl);\r\n        const data = await response.json();\r\n\r\n        if (!response.ok) {\r\n            return NextResponse.json(data, { status: response.status });\r\n        }\r\n\r\n        // If operation is done and has a video URI, rewrite it\r\n        let videoEntry = data.response?.generatedVideos?.[0]?.video ||\r\n            data.response?.generateVideoResponse?.generatedSamples?.[0]?.video;\r\n\r\n        if (data.done && videoEntry?.uri) {\r\n            const originalUri = videoEntry.uri;\r\n            // Rewrite to local proxy\r\n            const localProxyUrl = `/api/video?url=${encodeURIComponent(originalUri)}`;\r\n\r\n            videoEntry.uri = localProxyUrl;\r\n        }\r\n\r\n        return NextResponse.json(data);\r\n    } catch (error: any) {\r\n        console.error('[API] Operation check error:', error);\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,qBAAqB;AAEpB,eAAe,IAAI,GAAgB,EAAE,KAA8C;IACtF,IAAI;QACA,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc,IAAI,QAAQ,GAAG,CAAC,OAAO;QAChE,IAAI,CAAC,QAAQ;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8C,GAAG;gBAAE,QAAQ;YAAI;QACrG;QAEA,MAAM,SAAS,MAAM,MAAM,MAAM;QACjC,MAAM,gBAAgB,OAAO,IAAI,CAAC,IAAI,CAAC;QAEvC,uBAAuB;QACvB,MAAM,YAAY,GAAG,mBAAmB,CAAC,EAAE,cAAc,KAAK,EAAE,QAAQ;QAExE,MAAM,WAAW,MAAM,MAAM;QAC7B,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAC7D;QAEA,uDAAuD;QACvD,IAAI,aAAa,KAAK,QAAQ,EAAE,iBAAiB,CAAC,EAAE,EAAE,SAClD,KAAK,QAAQ,EAAE,uBAAuB,kBAAkB,CAAC,EAAE,EAAE;QAEjE,IAAI,KAAK,IAAI,IAAI,YAAY,KAAK;YAC9B,MAAM,cAAc,WAAW,GAAG;YAClC,yBAAyB;YACzB,MAAM,gBAAgB,CAAC,eAAe,EAAE,mBAAmB,cAAc;YAEzE,WAAW,GAAG,GAAG;QACrB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrE;AACJ"}}]
}