{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/video-gen/app/api/generate/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst externalApiBaseUrl = 'https://generativelanguage.googleapis.com/v1beta';\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const apiKey = process.env.GEMINI_API_KEY || process.env.API_KEY;\r\n        if (!apiKey) {\r\n            return NextResponse.json({ error: 'Server configuration error: API Key missing' }, { status: 500 });\r\n        }\r\n\r\n        const body = await req.json();\r\n        const modelName = 'veo-3.1-fast-generate-preview';\r\n\r\n        // Construct target URL\r\n        const targetUrl = `${externalApiBaseUrl}/models/${modelName}:generateVideos?key=${apiKey}`;\r\n\r\n        console.log(`[API] Starting generation with model: ${modelName}`);\r\n\r\n        const response = await fetch(targetUrl, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(body)\r\n        });\r\n\r\n        const responseText = await response.text();\r\n        console.log(`[API] Raw response status: ${response.status}`);\r\n\r\n        let data;\r\n        try {\r\n            data = JSON.parse(responseText);\r\n        } catch (e) {\r\n            console.error('[API] Failed to parse JSON response. Status:', response.status);\r\n            console.error('[API] Raw Response:', responseText);\r\n            return NextResponse.json({\r\n                error: 'Invalid response from upstream API',\r\n                status: response.status,\r\n                details: responseText.substring(0, 500)\r\n            }, { status: response.status === 200 ? 500 : response.status });\r\n        }\r\n\r\n        if (!response.ok) {\r\n            console.error('[API] Upstream error:', data);\r\n            return NextResponse.json(data, { status: response.status });\r\n        }\r\n\r\n        return NextResponse.json(data);\r\n    } catch (error: any) {\r\n        console.error('[API] Generate error:', error);\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,qBAAqB;AAEpB,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc,IAAI,QAAQ,GAAG,CAAC,OAAO;QAChE,IAAI,CAAC,QAAQ;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8C,GAAG;gBAAE,QAAQ;YAAI;QACrG;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,YAAY;QAElB,uBAAuB;QACvB,MAAM,YAAY,GAAG,mBAAmB,QAAQ,EAAE,UAAU,oBAAoB,EAAE,QAAQ;QAE1F,QAAQ,GAAG,CAAC,CAAC,sCAAsC,EAAE,WAAW;QAEhE,MAAM,WAAW,MAAM,MAAM,WAAW;YACpC,QAAQ;YACR,SAAS;gBACL,gBAAgB;YACpB;YACA,MAAM,KAAK,SAAS,CAAC;QACzB;QAEA,MAAM,eAAe,MAAM,SAAS,IAAI;QACxC,QAAQ,GAAG,CAAC,CAAC,2BAA2B,EAAE,SAAS,MAAM,EAAE;QAE3D,IAAI;QACJ,IAAI;YACA,OAAO,KAAK,KAAK,CAAC;QACtB,EAAE,OAAO,GAAG;YACR,QAAQ,KAAK,CAAC,gDAAgD,SAAS,MAAM;YAC7E,QAAQ,KAAK,CAAC,uBAAuB;YACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACrB,OAAO;gBACP,QAAQ,SAAS,MAAM;gBACvB,SAAS,aAAa,SAAS,CAAC,GAAG;YACvC,GAAG;gBAAE,QAAQ,SAAS,MAAM,KAAK,MAAM,MAAM,SAAS,MAAM;YAAC;QACjE;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,QAAQ,KAAK,CAAC,yBAAyB;YACvC,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAC7D;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrE;AACJ"}}]
}